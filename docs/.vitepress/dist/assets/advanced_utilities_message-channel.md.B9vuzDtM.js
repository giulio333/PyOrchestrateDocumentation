import{_ as e,c as a,a2 as i,o as t}from"./chunks/framework.BkvI1e0W.js";const c=JSON.parse('{"title":"Message Channel","description":"","frontmatter":{"title":"Message Channel","editLink":true},"headers":[],"relativePath":"advanced/utilities/message-channel.md","filePath":"advanced/utilities/message-channel.md","lastUpdated":1761471006000}'),n={name:"advanced/utilities/message-channel.md"};function l(o,s,h,r,p,d){return t(),a("div",null,s[0]||(s[0]=[i(`<h1 id="message-channel" tabindex="-1">Message Channel <a class="header-anchor" href="#message-channel" aria-label="Permalink to &quot;Message Channel&quot;">​</a></h1><p>This page documents the internal Message Channel used by the framework. It is intended for maintainers and integrators who need to understand the message formats and the role of the channel within the system. The module is consumed by framework components such as the orchestrator, agents, CLI and webclient — it is not a user-facing API.</p><h2 id="purpose" tabindex="-1">Purpose <a class="header-anchor" href="#purpose" aria-label="Permalink to &quot;Purpose&quot;">​</a></h2><p>The Message Channel is a transport-agnostic primitive that carries logical envelopes between framework components. It standardizes message shapes, framing, correlation and basic validation so higher-level components can focus on application logic.</p><h2 id="supported-message-types" tabindex="-1">Supported message types <a class="header-anchor" href="#supported-message-types" aria-label="Permalink to &quot;Supported message types&quot;">​</a></h2><p>Two logical message types are supported: COMMAND and STATUS. Both are serialized as JSON envelopes with a small set of top-level fields.</p><h3 id="envelope-fields-top-level" tabindex="-1">Envelope fields (top level) <a class="header-anchor" href="#envelope-fields-top-level" aria-label="Permalink to &quot;Envelope fields (top level)&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Field</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>sender</code></td><td>string</td><td>Origin identifier (agent id, orchestrator, etc.)</td></tr><tr><td><code>event_name</code></td><td>string</td><td>Logical message type: <code>&quot;COMMAND&quot;</code> or <code>&quot;STATUS&quot;</code></td></tr><tr><td><code>payload</code></td><td>object</td><td>Message-specific content (always a JSON object)</td></tr><tr><td><code>timestamp</code></td><td>string</td><td>ISO8601 timestamp for envelope creation</td></tr></tbody></table><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>When sending envelopes over stream transports, prefer line-delimited JSON (one JSON object per line) to simplify framing.</p></div><h3 id="command-—-request" tabindex="-1">COMMAND — request <a class="header-anchor" href="#command-—-request" aria-label="Permalink to &quot;COMMAND — request&quot;">​</a></h3><p>Primary payload fields:</p><ul><li><code>command</code> (string): command name</li><li><code>args</code> (array): command arguments (structured)</li><li><code>request_id</code> (string): unique id to correlate request and response</li><li><code>meta</code> (object, optional): free-form metadata</li></ul><p>Example request envelope:</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	&quot;sender&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;agentX&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	&quot;event_name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;COMMAND&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	&quot;payload&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">		&quot;command&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;do_work&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">		&quot;args&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">		&quot;request_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;550e8400-e29b-41d4-a716-446655440000&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">		&quot;meta&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	},</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	&quot;timestamp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2025-10-05T12:34:56.789&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="command-—-response" tabindex="-1">COMMAND — response <a class="header-anchor" href="#command-—-response" aria-label="Permalink to &quot;COMMAND — response&quot;">​</a></h3><p>Primary payload fields:</p><ul><li><code>status</code> (&quot;success&quot; | &quot;error&quot;): outcome</li><li><code>code</code> (int): numeric status or error code</li><li><code>data</code> (object): response data when successful</li><li><code>error</code> (string): human-readable error message when applicable</li><li><code>request_id</code> (string): original request id for correlation</li><li><code>protocol_version</code> (string): protocol version used by the framework</li></ul><p>Example response envelope:</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	&quot;sender&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;orchestrator&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	&quot;event_name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;COMMAND&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	&quot;payload&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">		&quot;status&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;success&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">		&quot;code&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">		&quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {},</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">		&quot;error&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">		&quot;request_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;550e8400-e29b-41d4-a716-446655440000&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">		&quot;protocol_version&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;1.0&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	},</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	&quot;timestamp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2025-10-05T12:34:57.123&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="status" tabindex="-1">STATUS <a class="header-anchor" href="#status" aria-label="Permalink to &quot;STATUS&quot;">​</a></h3><p>Primary payload fields:</p><ul><li><code>status</code> (string): short state (e.g. &quot;running&quot;, &quot;idle&quot;)</li><li><code>event</code> (string): descriptive event name (e.g. &quot;heartbeat&quot;)</li><li><code>error</code> (string, optional): error message when applicable</li></ul><p>Example status envelope:</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	&quot;sender&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;agentX&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	&quot;event_name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;STATUS&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	&quot;payload&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">		&quot;status&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;running&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">		&quot;event&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;heartbeat&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">		&quot;error&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	},</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">	&quot;timestamp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2025-10-05T12:35:00.000&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="high-level-behaviour-internals" tabindex="-1">High-level behaviour (internals) <a class="header-anchor" href="#high-level-behaviour-internals" aria-label="Permalink to &quot;High-level behaviour (internals)&quot;">​</a></h2><ul><li>Transport-agnostic: the channel exposes a small, consistent surface so the rest of the framework does not need to know transport details (in-process queues, IPC, ZMQ).</li><li>Framing and serialization: messages are serialized to JSON and framed (line-delimited or transport-framed) by the channel implementation.</li><li>Validation and correlation: basic envelope validation is performed on receive; <code>request_id</code> is used to correlate COMMAND request/response flows.</li><li>Operational safeguards: the channel enforces timeouts, message size limits and clean shutdown semantics to protect the runtime.</li></ul><h2 id="how-the-framework-uses-the-channel-external-view" tabindex="-1">How the framework uses the channel (external view) <a class="header-anchor" href="#how-the-framework-uses-the-channel-external-view" aria-label="Permalink to &quot;How the framework uses the channel (external view)&quot;">​</a></h2><ul><li>Orchestrator ↔ CLI/Webclient: the orchestrator typically exposes a network endpoint (e.g. ZeroMQ ROUTER). CLI and webclient components act as clients and exchange COMMAND messages with the orchestrator.</li><li>Orchestrator ↔ Agents: the orchestrator and agents communicate using queues or network transports. Agents emit STATUS messages (heartbeats, state changes) and receive COMMAND messages from the orchestrator.</li></ul><p>The module is internal: application code interacts with higher-level framework APIs rather than the channel directly.</p><h2 id="operational-notes" tabindex="-1">Operational notes <a class="header-anchor" href="#operational-notes" aria-label="Permalink to &quot;Operational notes&quot;">​</a></h2><ul><li>Use line-delimited JSON when sending envelopes over stream transports (one JSON object per line).</li><li>Avoid embedding unescaped newlines inside the top-level JSON envelope.</li><li>Always include <code>request_id</code> for COMMAND requests that expect a response.</li><li>Respect <code>protocol_version</code> when interpreting COMMAND responses for compatibility.</li><li>Ensure clean shutdown of transport endpoints to avoid stale socket files or resources.</li></ul><h2 id="see-also" tabindex="-1">See also <a class="header-anchor" href="#see-also" aria-label="Permalink to &quot;See also&quot;">​</a></h2><ul><li>Search the codebase for <code>ServiceMessage</code> and <code>MessageChannel</code> to inspect implementation details.</li></ul><hr><h2 id="title-message-channeleditlink-true" tabindex="-1">title: Message Channel editLink: true <a class="header-anchor" href="#title-message-channeleditlink-true" aria-label="Permalink to &quot;title: Message Channel
editLink: true&quot;">​</a></h2>`,35)]))}const u=e(n,[["render",l]]);export{c as __pageData,u as default};
